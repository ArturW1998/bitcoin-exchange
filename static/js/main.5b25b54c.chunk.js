(this["webpackJsonpbitcoin-exchange"]=this["webpackJsonpbitcoin-exchange"]||[]).push([[0],{1:function(e,t,n){e.exports={quoteTable:"styles_quoteTable__2wm5a",th:"styles_th__2FCC1",thSortDown:"styles_thSortDown__1z6Te",thSortUp:"styles_thSortUp__2R3D0",btn:"styles_btn__3sPcG",error:"styles_error__UmtkX",errorText:"styles_errorText__10Rma"}},17:function(e,t,n){e.exports=n(29)},28:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"tickers",(function(){return _}));var a=n(0),o=n.n(a),i=n(5),c=n(4),s={IS_PROD:!0,IS_DEV:!1},l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function u(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var d,m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),o(e),i(e)}))},f=n(3),p=n(2),b=n(16),h=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),{payload:t}},v={tickers:{set:Object(f.b)("tickers/set",h),update:Object(f.b)("tickers/update",h)},symbols:{set:Object(f.b)("tickers/symbols/set")},toggleDarkTheme:Object(f.b)("tickers/toggle/DarkTheme"),setSortType:Object(f.b)("tickers/sortType/set"),toggleLimit:Object(f.b)("tickers/toggle/limit50")},y=v.tickers,g=v.symbols,E=v.toggleDarkTheme,k=v.setSortType,w=v.toggleLimit,T=Object(f.c)({data:[],previousData:{},symbols:{},onLimit50:!0,sortType:{field:"last",type:"down"},isDarkTheme:!1},(function(e){e.addCase(y.set,(function(e,t){var n=e.data;t.payload.forEach((function(e){n.push(e)}))})).addCase(y.update,(function(e,t){var n=e.data,r=e.previousData,a=t.payload;Object.keys(r).forEach((function(e){return delete r[e]})),a.forEach((function(e){var t=n.findIndex((function(t){return t.symbol===e.symbol}));-1!==t?(r[e.symbol]=Object(b.a)({},n[t]),n[t]=e):n.push(e)}))})).addCase(g.set,(function(e,t){var n=e.symbols;t.payload.forEach((function(e){n[e.id]=e}))})).addCase(E,(function(e){e.isDarkTheme=!e.isDarkTheme})).addCase(k,(function(e,t){var n=t.payload;e.sortType=n})).addCase(w,(function(e){e.onLimit50=!e.onLimit50}))})),S=function(e){return e.tickers},_=T,O=Object(f.a)({reducer:Object(p.b)(r),devTools:s.IS_DEV}),L=n(10),D=n(11),C=n(15),j=n(13),x=n(1),P=n.n(x),A=function(e){var t=e.children;return o.a.createElement("div",{className:P.a.error},o.a.createElement("p",{className:P.a.errorText},"Something went wrong!"),t)},N=function(e){Object(C.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(L.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={hasError:!1},e}return Object(D.a)(n,[{key:"render",value:function(){var e=this.state.hasError,t=this.props.children;return e?o.a.createElement(A,null):t}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),n}(a.Component),B=function(e,t){return function(n,r){var a="symbol"===e,o=a?n[e]:+n[e],i=a?r[e]:+r[e],c=!t||"up"===t;return o>i?c?1:-1:o<i?c?-1:1:0}},U=n(14),I=function(e,t){var n=B("last","down"),r=Object(U.a)(e.data);return r=r.sort(n),e.onLimit50&&(r=r.slice(0,49)),r=r.sort(B(t.field,t.type))},R={CELL_VALUE_UP:"text-success",CELL_VALUE_DOWN:"text-danger",DARK:{TABLE:"table-dark"}},W=function(e,t,n,r){var a="",o=e[r.field];"symbol"===r.field&&(o="".concat(t.baseCurrency," / ").concat(t.feeCurrency));if(null!==n)switch(r.compare(e,n)){case-1:a=R.CELL_VALUE_DOWN;break;case 1:a=R.CELL_VALUE_UP}return{extClasses:a,value:o}},M=function(e,t){var n="";return e.field===t.field&&(n="up"===t.type?P.a.thSortUp:P.a.thSortDown),n},F=n(8),J=n.n(F),V=n(12);!function(e){e.GET_SYMBOLS="getSymbols",e.SUBSCRIBE_TICKER="subscribeTicker"}(d||(d={}));var q,H=d,K=function(e){return new Promise((function(t){e.addEventListener("message",(function n(r){var a=r.data,o=JSON.parse(a);e.removeEventListener("message",n),t(o.result)})),e.send(JSON.stringify({id:H.GET_SYMBOLS,method:H.GET_SYMBOLS}))}))},G=function(e,t){return new Promise((function(n){var r=new Map;e.addEventListener("message",(function a(o){var i=o.data,c=JSON.parse(i);if("method"in c&&"ticker"===c.method){var s=c.params;r.set(s.symbol,s),r.size===t.length&&(n(r),e.removeEventListener("message",a))}})),t.forEach((function(t){return e.send(JSON.stringify({id:H.SUBSCRIBE_TICKER,method:H.SUBSCRIBE_TICKER,params:{symbol:t.id}}))}))}))},Y=function(e,t){var n=new Map,r=Date.now();e.addEventListener("message",(function(e){var a=e.data,o=JSON.parse(a).params;if(n.set(o.symbol,o),Date.now()-r>50){var i=v.tickers;t(i.update(n)),r=Date.now(),n.clear()}}))};!function(e){e.BASE_PATH="wss://api.exchange.bitcoin.com/api/2/ws",e.WS_PATH="/ws"}(q||(q={}));var z=q,Q=function(e){return new Promise((function(t){e.addEventListener("open",(function(){return t()}))}))},X=function(){var e=Object(V.a)(J.a.mark((function e(t,n){var r,a,o,i;return J.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q(t);case 2:return e.next=4,K(t);case 4:return r=e.sent,a=v.symbols,o=v.tickers,n(a.set(r)),e.next=9,G(t,r);case 9:i=e.sent,n(o.set(i)),Y(t,n);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$=[{title:"Ticker",field:"symbol",compare:B("symbol")},{title:"Bid",field:"bid",compare:B("bid")},{title:"Ask",field:"ask",compare:B("ask")},{title:"High",field:"high",compare:B("high")},{title:"Low",field:"low",compare:B("low")},{title:"Last",field:"last",compare:B("last")}],Z=Object(a.memo)((function(e){var t=e.ticker,n=e.previousTicker,r=e.symbol;return o.a.createElement("tr",{key:t.symbol},$.map((function(e){var a=W(t,r,n,e),i=a.extClasses,c=a.value;return o.a.createElement("td",{key:e.field,className:"".concat(i," ").concat(P.a.th)},c)})))})),ee=function(e){var t=e.dispatch,n=e.sortParams;return o.a.createElement("thead",null,o.a.createElement("tr",null,$.map((function(e){var r=M(e,n);return o.a.createElement("th",{key:e.field,className:r,onClick:function(){var r={type:n.field===e.field&&"down"===n.type?"up":"down",field:e.field};t(v.setSortType(r))}},e.title)}))))},te=function(e){var t=e.data,n=e.previousData,r=e.themeDark,a=e.symbolsMap,i=e.sortParams,c=e.dispatch,s=r?R.DARK.TABLE:"";return o.a.createElement("div",{className:"table-responsive"},o.a.createElement("table",{className:"table table-striped ".concat(P.a.quoteTable," ").concat(s)},o.a.createElement(ee,{dispatch:c,sortParams:i}),o.a.createElement("tbody",null,t.map((function(e){var t=n[e.symbol]||null,r=a[e.symbol];return o.a.createElement(Z,{key:e.symbol,previousTicker:t,symbol:r,ticker:e})})))))},ne=function(){var e=Object(c.b)(),t=Object(c.c)(S),n=t.sortType;Object(a.useEffect)((function(){var t=new WebSocket("".concat(z.BASE_PATH).concat(z.WS_PATH));return X(t,e),function(){t.close()}}),[e]);var r=I(t,n);return o.a.createElement(te,{data:r,dispatch:e,previousData:t.previousData,sortParams:n,symbolsMap:t.symbols,themeDark:t.isDarkTheme})},re=function(){var e=Object(c.b)(),t=v.toggleLimit,n=v.toggleDarkTheme,r=[{id:"Limit tickers",action:t(),text:"On / Off Limit tickers"},{id:"Dark Theme",action:n(),text:"On / Off Dark Theme"}];return o.a.createElement("div",{"aria-label":"Quote Tickers controls"},r.map((function(t,n){var i=t.id,c=t.action,s=t.text;return o.a.createElement(a.Fragment,{key:i},o.a.createElement("button",{className:"btn btn-primary ".concat(P.a.btn),onClick:function(){e(c)},type:"button"},s),n!==r.length-1&&" ")})))},ae=(n(27),function(){var e=[{id:"quoteTickersControls",component:re},{id:"quoteTable",component:ne}];return o.a.createElement("div",{className:"container-lg"},e.map((function(e){var t=e.id,n=e.component;return o.a.createElement("div",{key:t,className:"row pt-3"},o.a.createElement("div",{className:"col"},o.a.createElement(n,null)))})))});n(28);Object(i.render)(o.a.createElement(a.StrictMode,null,o.a.createElement(c.a,{store:O},o.a.createElement(N,null,o.a.createElement(ae,null)))),document.getElementById("root")),function(e){if(s.IS_PROD&&"serviceWorker"in navigator){if(new URL("/bitcoin-exchange",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/bitcoin-exchange","/service-worker.js");l?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&!r.includes("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):u(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):u(t,e)}))}}(),s.IS_DEV&&m(console.log)}},[[17,1,2]]]);
//# sourceMappingURL=main.5b25b54c.chunk.js.map