(this["webpackJsonpbitcoin-exchange"]=this["webpackJsonpbitcoin-exchange"]||[]).push([[0],{1:function(e,t,n){e.exports={quoteTable:"styles_quoteTable__2wm5a",th:"styles_th__2FCC1",thSortDown:"styles_thSortDown__1z6Te",thSortUp:"styles_thSortUp__2R3D0",btn:"styles_btn__3sPcG",error:"styles_error__UmtkX",errorTitle:"styles_errorTitle__1V28p",errorMessage:"styles_errorMessage__1NebD"}},17:function(e,t,n){e.exports=n(29)},28:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"tickers",(function(){return C}));var a=n(0),o=n.n(a),i=n(5),c=n(4),s={IS_PROD:!0,IS_DEV:!1},l=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function u(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var m,d=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),o(e),i(e)}))},f=n(2),p=n(3),v=n(16);!function(e){e.UP="up",e.DOWN="down"}(m||(m={}));var b,h=m,E=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),{payload:t}},y={tickers:{set:Object(f.b)("tickers/set",E),update:Object(f.b)("tickers/update",E)},symbols:{set:Object(f.b)("tickers/symbols/set")},toggleDarkTheme:Object(f.b)("tickers/toggle/DarkTheme"),setSortType:Object(f.b)("tickers/sortType/set"),toggleLimit:Object(f.b)("tickers/toggle/limit50"),setError:Object(f.b)("tickers/set/error")},g={data:[],previousData:{},symbols:{},onLimit50:!0,sortType:{field:"last",type:h.DOWN},isDarkTheme:!1,error:null},k=y.tickers,T=y.symbols,w=y.toggleDarkTheme,O=y.setSortType,_=y.toggleLimit,D=y.setError,S=Object(f.c)(g,(function(e){e.addCase(k.set,(function(e,t){var n=e.data;t.payload.forEach((function(e){n.push(e)}))})).addCase(k.update,(function(e,t){var n=e.data,r=e.previousData,a=t.payload;Object.keys(r).forEach((function(e){return delete r[e]})),a.forEach((function(e){var t=n.findIndex((function(t){return t.symbol===e.symbol}));-1!==t?(r[e.symbol]=Object(v.a)({},n[t]),n[t]=e):n.push(e)}))})).addCase(T.set,(function(e,t){var n=e.symbols;t.payload.forEach((function(e){n[e.id]=e}))})).addCase(w,(function(e){e.isDarkTheme=!e.isDarkTheme})).addCase(O,(function(e,t){var n=t.payload;e.sortType=n})).addCase(_,(function(e){e.onLimit50=!e.onLimit50})).addCase(D,(function(e,t){var n=t.payload;e.error=n}))})),L=function(e){return e.tickers},C=S,N=Object(f.a)({reducer:Object(p.b)(r),devTools:s.IS_DEV}),P=n(10),j=n(11),U=n(15),A=n(13),W=n(1),x=n.n(W),B=function(e){var t=e.children,n=e.message;return o.a.createElement("div",{className:x.a.error},o.a.createElement("p",{className:x.a.errorTitle},"Something went wrong!"),n&&o.a.createElement("p",{className:x.a.errorMessage},n),t)},I=function(e){Object(U.a)(n,e);var t=Object(A.a)(n);function n(){var e;Object(P.a)(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={hasError:!1},e}return Object(j.a)(n,[{key:"render",value:function(){var e=this.state.hasError,t=this.props.children;return e?o.a.createElement(B,null):t}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),n}(a.Component),M=function(e,t){return function(n,r){var a="symbol"===e,o=a?n[e]:+n[e],i=a?r[e]:+r[e],c=!t||t===h.UP;return o>i?c?1:-1:o<i?c?-1:1:0}},R=n(14),V=function(e,t){var n=M("last",h.DOWN),r=Object(R.a)(e.data);return r=r.sort(n),e.onLimit50&&(r=r.slice(0,49)),r=r.sort(M(t.field,t.type))},F={CELL_VALUE_UP:"text-success",CELL_VALUE_DOWN:"text-danger",DARK:{TABLE:"table-dark"}};!function(e){e[e.DOWN=-1]="DOWN",e[e.UP=1]="UP",e[e.MIDDLE=0]="MIDDLE"}(b||(b={}));var J,q=b,H=function(e,t,n,r){var a="",o=e[r.field];if("symbol"===r.field&&(o="".concat(t.baseCurrency," / ").concat(t.feeCurrency)),null!==n)switch(r.compare(e,n)){case q.DOWN:a=F.CELL_VALUE_DOWN;break;case q.UP:a=F.CELL_VALUE_UP}return{extClasses:a,value:o}},K=function(e,t){var n="";return e.field===t.field&&(n=t.type===h.UP?x.a.thSortUp:x.a.thSortDown),n},G=n(8),Y=n.n(G),z=n(12);!function(e){e.GET_SYMBOLS="getSymbols",e.SUBSCRIBE_TICKER="subscribeTicker"}(J||(J={}));var Q,X=J,$=function(e){return new Promise((function(t){e.addEventListener("message",(function n(r){var a=r.data,o=JSON.parse(a);e.removeEventListener("message",n),t(o.result)})),e.send(JSON.stringify({id:X.GET_SYMBOLS,method:X.GET_SYMBOLS}))}))},Z=function(e,t){return new Promise((function(n){var r=new Map;e.addEventListener("message",(function a(o){var i=o.data,c=JSON.parse(i);if("method"in c&&"ticker"===c.method){var s=c.params;r.set(s.symbol,s),r.size===t.length&&(n(r),e.removeEventListener("message",a))}})),t.forEach((function(t){return e.send(JSON.stringify({id:X.SUBSCRIBE_TICKER,method:X.SUBSCRIBE_TICKER,params:{symbol:t.id}}))}))}))},ee=function(e,t){var n=new Map,r=Date.now();e.addEventListener("message",(function(e){var a=e.data,o=JSON.parse(a).params;if(n.set(o.symbol,o),Date.now()-r>50){var i=y.tickers;t(i.update(n)),r=Date.now(),n.clear()}}))};!function(e){e.BASE_PATH="wss://api.exchange.bitcoin.com/api/2/ws",e.WS_PATH="/ws"}(Q||(Q={}));var te,ne=Q;!function(e){e.UNABLE_TO_CONNECT="Unable to connect to the server to get ticker data. The server may have stopped working."}(te||(te={}));var re=te,ae=function(e,t){var n=y.setError;return new Promise((function(r){e.addEventListener("open",(function(){return r()})),e.addEventListener("error",(function(){return t(n(re.UNABLE_TO_CONNECT))}))}))},oe=function(){var e=Object(z.a)(Y.a.mark((function e(t,n){var r,a,o,i;return Y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae(t,n);case 2:return e.next=4,$(t);case 4:return r=e.sent,a=y.symbols,o=y.tickers,n(a.set(r)),e.next=9,Z(t,r);case 9:i=e.sent,n(o.set(i)),ee(t,n);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),ie=[{title:"Ticker",field:"symbol",compare:M("symbol")},{title:"Bid",field:"bid",compare:M("bid")},{title:"Ask",field:"ask",compare:M("ask")},{title:"High",field:"high",compare:M("high")},{title:"Low",field:"low",compare:M("low")},{title:"Last",field:"last",compare:M("last")}],ce=Object(a.memo)((function(e){var t=e.ticker,n=e.previousTicker,r=e.symbol;return o.a.createElement("tr",{key:t.symbol},ie.map((function(e){var a=H(t,r,n,e),i=a.extClasses,c=a.value;return o.a.createElement("td",{key:e.field,className:"".concat(i," ").concat(x.a.th)},c)})))})),se=function(e){var t=e.dispatch,n=e.sortParams;return o.a.createElement("thead",null,o.a.createElement("tr",null,ie.map((function(e){var r=K(e,n);return o.a.createElement("th",{key:e.field,className:r,onClick:function(){var r={type:n.field===e.field&&n.type===h.DOWN?h.UP:h.DOWN,field:e.field};t(y.setSortType(r))}},e.title)}))))},le=function(e){var t=e.data,n=e.previousData,r=e.themeDark,a=e.symbolsMap,i=e.sortParams,c=e.dispatch,s=r?F.DARK.TABLE:"";return o.a.createElement("div",{className:"table-responsive"},o.a.createElement("table",{className:"table table-striped ".concat(x.a.quoteTable," ").concat(s)},o.a.createElement(se,{dispatch:c,sortParams:i}),o.a.createElement("tbody",null,t.map((function(e){var t=n[e.symbol]||null,r=a[e.symbol];return o.a.createElement(ce,{key:e.symbol,previousTicker:t,symbol:r,ticker:e})})))))},ue=function(e){var t=e.tickersState,n=Object(c.b)(),r=t.sortType;Object(a.useEffect)((function(){var e=new WebSocket("".concat(ne.BASE_PATH).concat(ne.WS_PATH));return oe(e,n),function(){e.close()}}),[n]);var i=V(t,r);return o.a.createElement(le,{data:i,dispatch:n,previousData:t.previousData,sortParams:r,symbolsMap:t.symbols,themeDark:t.isDarkTheme})},me=function(){var e=Object(c.b)(),t=y.toggleLimit,n=y.toggleDarkTheme,r=[{id:"Limit tickers",action:t(),text:"On / Off Limit tickers"},{id:"Dark Theme",action:n(),text:"On / Off Dark Theme"}];return o.a.createElement("div",{"aria-label":"Quote Tickers controls"},r.map((function(t,n){var i=t.id,c=t.action,s=t.text;return o.a.createElement(a.Fragment,{key:i},o.a.createElement("button",{className:"btn btn-primary ".concat(x.a.btn),onClick:function(){e(c)},type:"button"},s),n!==r.length-1&&" ")})))},de=(n(27),function(){var e=Object(c.c)(L),t=[{id:"quoteTickersControls",component:o.a.createElement(me,null)},{id:"quoteTable",component:o.a.createElement(ue,{tickersState:e})}];return e.error?o.a.createElement(B,{message:e.error}):o.a.createElement("div",{className:"container-lg"},t.map((function(e){var t=e.id,n=e.component;return o.a.createElement("div",{key:t,className:"row pt-3"},o.a.createElement("div",{className:"col"},n))})))});n(28);Object(i.render)(o.a.createElement(a.StrictMode,null,o.a.createElement(c.a,{store:N},o.a.createElement(I,null,o.a.createElement(de,null)))),document.getElementById("root")),function(e){if(s.IS_PROD&&"serviceWorker"in navigator){if(new URL("/bitcoin-exchange",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/bitcoin-exchange","/service-worker.js");l?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&!r.includes("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):u(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):u(t,e)}))}}(),s.IS_DEV&&d(console.log)}},[[17,1,2]]]);
//# sourceMappingURL=main.701f406a.chunk.js.map