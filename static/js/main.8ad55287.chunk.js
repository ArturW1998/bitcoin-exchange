(this["webpackJsonpbitcoin-exchange"]=this["webpackJsonpbitcoin-exchange"]||[]).push([[0],{2:function(e,t,n){e.exports={quoteTable:"styles_quoteTable__2wm5a",th:"styles_th__2FCC1",thSortDown:"styles_thSortDown__1z6Te",thSortUp:"styles_thSortUp__2R3D0",btn:"styles_btn__3sPcG",error:"styles_error__UmtkX",errorText:"styles_errorText__10Rma"}},28:function(e,t,n){},29:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(5),a=n(4),i={IS_PROD:!0,IS_DEV:!1},c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var l,u=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,30)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),r(e),o(e),a(e),i(e)}))},d=n(3),f=n(16),b=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),{payload:t}},h={tickers:{set:Object(d.b)("tickers/set",b),update:Object(d.b)("tickers/update",b)},symbols:{set:Object(d.b)("tickers/symbols/set")},toggleDarkTheme:Object(d.b)("tickers/toggle/DarkTheme"),setSortType:Object(d.b)("tickers/sortType/set"),toggleLimit:Object(d.b)("tickers/toggle/limit50")},m=h.tickers,p=h.symbols,v=h.toggleDarkTheme,j=h.setSortType,g=h.toggleLimit,y={reducer:Object(d.c)({data:[],previousData:{},symbols:{},onLimit50:!0,sortType:{field:"last",type:"down"},isDarkTheme:!1},(function(e){e.addCase(m.set,(function(e,t){var n=e.data;t.payload.forEach((function(e){n.push(e)}))})).addCase(m.update,(function(e,t){var n=e.data,r=e.previousData,o=t.payload;Object.keys(r).forEach((function(e){return delete r[e]})),o.forEach((function(e){var t=n.findIndex((function(t){return t.symbol===e.symbol}));-1!==t?(r[e.symbol]=Object(f.a)({},n[t]),n[t]=e):n.push(e)}))})).addCase(p.set,(function(e,t){var n=e.symbols;t.payload.forEach((function(e){n[e.id]=e}))})).addCase(v,(function(e){e.isDarkTheme=!e.isDarkTheme})).addCase(j,(function(e,t){var n=t.payload;e.sortType=n})).addCase(g,(function(e){e.onLimit50=!e.onLimit50}))})),actions:h},O=Object(d.a)({reducer:{tickers:y.reducer},devTools:i.IS_DEV}),k=n(10),w=n(11),x=n(15),T=n(13),S=n(2),E=n.n(S),_=n(1),L=function(e){var t=e.children;return Object(_.jsxs)("div",{className:E.a.error,children:[Object(_.jsx)("p",{className:E.a.errorText,children:"Something went wrong!"}),t]})},D=function(e){Object(x.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={hasError:!1},e}return Object(w.a)(n,[{key:"render",value:function(){var e=this.state.hasError,t=this.props.children;return e?Object(_.jsx)(L,{}):t}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),n}(r.Component),C=function(e,t){return function(n,r){var o="symbol"===e,a=o?n[e]:+n[e],i=o?r[e]:+r[e],c=!t||"up"===t;return a>i?c?1:-1:a<i?c?-1:1:0}},P=n(14),A=function(e,t){var n=C("last","down"),r=Object(P.a)(e.data);return r=r.sort(n),e.onLimit50&&(r=r.slice(0,49)),r=r.sort(C(t.field,t.type))},N={CELL_VALUE_UP:"text-success",CELL_VALUE_DOWN:"text-danger",DARK:{TABLE:"table-dark"}},B=function(e,t,n,r){var o="",a=e[r.field];"symbol"===r.field&&(a="".concat(t.baseCurrency," / ").concat(t.feeCurrency));if(null!==n)switch(r.compare(e,n)){case-1:o=N.CELL_VALUE_DOWN;break;case 1:o=N.CELL_VALUE_UP}return{extClasses:o,value:a}},U=function(e){return e.tickers},I=n(9),R=n.n(I),W=n(12);!function(e){e.GET_SYMBOLS="getSymbols",e.SUBSCRIBE_TICKER="subscribeTicker"}(l||(l={}));var M,F=l,J=function(e){return new Promise((function(t){e.addEventListener("message",(function n(r){var o=r.data,a=JSON.parse(o);e.removeEventListener("message",n),t(a.result)})),e.send(JSON.stringify({id:F.GET_SYMBOLS,method:F.GET_SYMBOLS}))}))},V=function(e,t){return new Promise((function(n){var r=new Map;e.addEventListener("message",(function o(a){var i=a.data,c=JSON.parse(i);if("method"in c&&"ticker"===c.method){var s=c.params;r.set(s.symbol,s),r.size===t.length&&(n(r),e.removeEventListener("message",o))}})),t.forEach((function(t){return e.send(JSON.stringify({id:F.SUBSCRIBE_TICKER,method:F.SUBSCRIBE_TICKER,params:{symbol:t.id}}))}))}))},q=function(e,t){var n=new Map,r=Date.now();e.addEventListener("message",(function(e){var o=e.data,a=JSON.parse(o).params;if(n.set(a.symbol,a),Date.now()-r>50){var i=y.actions.tickers;t(i.update(n)),r=Date.now(),n.clear()}}))};!function(e){e.BASE_PATH="wss://api.exchange.bitcoin.com/api/2/ws",e.WS_PATH="/ws"}(M||(M={}));var H=M,K=function(e){return new Promise((function(t){e.addEventListener("open",(function(){return t()}))}))},G=function(){var e=Object(W.a)(R.a.mark((function e(t,n){var r,o,a,i,c;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(t);case 2:return e.next=4,J(t);case 4:return r=e.sent,a=(o=y.actions).symbols,i=o.tickers,n(a.set(r)),e.next=9,V(t,r);case 9:c=e.sent,n(i.set(c)),q(t,n);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Y=[{title:"Ticker",field:"symbol",compare:C("symbol")},{title:"Bid",field:"bid",compare:C("bid")},{title:"Ask",field:"ask",compare:C("ask")},{title:"High",field:"high",compare:C("high")},{title:"Low",field:"low",compare:C("low")},{title:"Last",field:"last",compare:C("last")}],z=function(e){var t=e.ticker,n=e.previousTicker,r=e.symbol;return Object(_.jsx)("tr",{children:Y.map((function(e){var o=B(t,r,n,e),a=o.extClasses,i=o.value;return Object(_.jsx)("td",{className:"".concat(a," ").concat(E.a.th),children:i},e.field)}))},t.symbol)},Q=Object(r.memo)(z),X=function(e){var t=e.dispatch,n=e.sortParams;return Object(_.jsx)("thead",{children:Object(_.jsx)("tr",{children:Y.map((function(e){var r="";e.field===n.field&&(r="up"===n.type?E.a.thSortUp:E.a.thSortDown);var o=y.actions.setSortType;return Object(_.jsx)("th",{className:r,onClick:function(){t(o({type:n.field===e.field&&"down"===n.type?"up":"down",field:e.field}))},children:e.title},e.field)}))})})},$=function(e){var t=e.data,n=e.previousData,r=e.themeDark,o=e.symbolsMap,a=e.sortParams,i=e.dispatch,c=r?N.DARK.TABLE:"";return Object(_.jsx)("div",{className:"table-responsive",children:Object(_.jsxs)("table",{className:"table table-striped ".concat(E.a.quoteTable," ").concat(c),children:[Object(_.jsx)(X,{dispatch:i,sortParams:a}),Object(_.jsx)("tbody",{children:t.map((function(e){var t=n[e.symbol]||null,r=o[e.symbol];return Object(_.jsx)(Q,{previousTicker:t,symbol:r,ticker:e},e.symbol)}))})]})})},Z=function(){var e=Object(a.b)(),t=Object(a.c)(U),n=t.sortType;Object(r.useEffect)((function(){var t=new WebSocket("".concat(H.BASE_PATH).concat(H.WS_PATH));return G(t,e),function(){t.close()}}),[e]);var o=A(t,n);return Object(_.jsx)($,{data:o,dispatch:e,previousData:t.previousData,sortParams:n,symbolsMap:t.symbols,themeDark:t.isDarkTheme})},ee=function(){var e=Object(a.b)(),t=y.actions,n=t.toggleLimit,o=t.toggleDarkTheme,i=[{id:"Limit tickers",action:n(),text:"On / Off Limit tickers"},{id:"Dark Theme",action:o(),text:"On / Off Dark Theme"}];return Object(_.jsx)("div",{"aria-label":"Quote Tickers controls",children:i.map((function(t,n){var o=t.id,a=t.action,c=t.text;return Object(_.jsxs)(r.Fragment,{children:[Object(_.jsx)("button",{className:"btn btn-primary ".concat(E.a.btn),onClick:function(){e(a)},type:"button",children:c}),n!==i.length-1&&" "]},o)}))})},te=(n(27),function(){var e=[{id:"quoteTickersControls",component:ee},{id:"quoteTable",component:Z}];return Object(_.jsx)("div",{className:"container-lg",children:e.map((function(e){var t=e.id,n=e.component;return Object(_.jsx)("div",{className:"row pt-3",children:Object(_.jsx)("div",{className:"col",children:Object(_.jsx)(n,{})})},t)}))})});n(28);Object(o.render)(Object(_.jsx)(r.StrictMode,{children:Object(_.jsx)(a.a,{store:O,children:Object(_.jsx)(D,{children:Object(_.jsx)(te,{})})})}),document.getElementById("root")),function(e){if(i.IS_PROD&&"serviceWorker"in navigator){if(new URL("/bitcoin-exchange/index",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/bitcoin-exchange/index","/service-worker.js");c?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var r=n.headers.get("content-type");404===n.status||null!=r&&!r.includes("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):s(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):s(t,e)}))}}(),i.IS_DEV&&u(console.log)}},[[29,1,2]]]);
//# sourceMappingURL=main.8ad55287.chunk.js.map